{% extends 'base.html.twig' %}

{% block title %}Inscriptions{% endblock %}

{% block body %}
    <h1>Inscriptions</h1>

    {% for message in app.flashes('success') %}
        <div style="background-color: #d4edda; color: #155724; padding: 1rem; border-radius: var(--radius); margin-bottom: 1rem;">
            {{ message }}
        </div>
    {% endfor %}

    <table class="table">
        <thead>
            <tr>
                {% if is_granted('ROLE_ADMIN') or is_granted('ROLE_GESTION') %}
                    <th>Élève</th>
                {% endif %}
                <th>Cours</th>
                <th>Professeur</th>
                {% if is_granted('ROLE_ADMIN') or is_granted('ROLE_GESTION') %}
                    <th>Nombre de paiements</th>
                {% endif %}
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
        {% for inscription in inscriptions %}
            <tr>
            {% if is_granted('ROLE_ADMIN') or is_granted('ROLE_GESTION') %}
                <td>
                    <a href="{{ path('app_eleves_show', {'id': inscription.eleves.id}) }}" style="color: #3b5bdb; text-decoration: underline; cursor: pointer;">
                        {{ inscription.eleves.nom }} {{ inscription.eleves.prenom }}
                    </a><br>
                </td>
            {% endif %}
                <td>
                    <a href="{{ path('app_cours_show', {'id': inscription.cours.id}) }}" style="color: #3b5bdb; text-decoration: underline; cursor: pointer;">
                        {{ inscription.cours.libelle }}
                    </a><br>
                </td>
                <td>
                    {% if inscription.cours.professeur %}
                        {{ inscription.cours.professeur.nom }} {{ inscription.cours.professeur.prenom }}
                    {% else %}
                        <span style="color: #6c757d;">Non assigné</span>
                    {% endif %}
                </td>
                {% if is_granted('ROLE_ADMIN') or is_granted('ROLE_GESTION') %}
                    <td>
                    {{ inscription.nombrePaiments }}
                    </td>
                {% endif %}
                <td>
                    <a href="{{ path('app_inscriptions_form', {'id': inscription.cours.id}) }}">S'inscrire</a>
                    
                    {% if is_granted('ROLE_ADMIN') or is_granted('ROLE_GESTION') %}
                        <a href="{{ path('app_inscriptions_show', {'id': inscription.id}) }}">Consulter</a>
                        <a href="{{ path('app_inscriptions_edit', {'id': inscription.id}) }}">Modifier</a>
                    {% endif %}
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="6">Aucune inscription trouvée</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    {% if is_granted('ROLE_ADMIN') or is_granted('ROLE_GESTION') %}
        <a href="{{ path('app_inscriptions_new') }}">Créer une nouvelle inscription</a>
    {% endif %}
{% endblock %}